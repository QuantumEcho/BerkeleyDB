<! "@(#)detect.so	10.8 (Sleepycat) 9/29/98">
<!Copyright 1997, 1998 by Sleepycat Software, Inc.  All rights reserved.>
<html>
<body bgcolor=white>
<head>
<title>Berkeley DB: DbLockTab.detect</title>
<meta name="description" content="Berkeley DB: An embedded database programmatic toolkit.">
<meta name="keywords" content="embedded,database,programmatic,toolkit,b+tree,btr
ee,hash,hashing,transaction,transactions,locking,logging,access method,access me
thods,java,C,C++">
</head>
<h1>DbLockTab.detect</h1>
<hr size=1 noshade>
<tt>
<h3>
<pre>
import com.sleepycat.db.*;
<p>
public void detect(int flags, int atype)
throws DbException;
</pre>
</h3>
<h1>Description</h1>
<p>
The DbLockTab.detect method runs one iteration of the deadlock detector.
The deadlock detector traverses the lock table, and for each deadlock
it finds, marks one of the participating transactions for abort.
<p>
The <b>flags</b> value is specified by logically <b>OR</b>'ing together one or more of the
following values:
<dl compact>
<a name="DB_LOCK_CONFLICT">
<p><dt>Db.DB_LOCK_CONFLICT<dd>Only run the deadlock detector if a lock conflict has occurred since
the last time that the deadlock detector was run.
</dl>
<p>
The <b>atype</b> parameter specifies which transaction to abort in the
case of deadlock.
It must be set to one of values described for the <b>lk_detect</b> field
of the
<a href="../../api_java/DbEnv/class.html">DbEnv</a> object.
<p>
The DbLockTab.detect method is the underlying method used by the <a href="../../utility/db_deadlock.html">db_deadlock</a> utility.
See the <a href="../../utility/db_deadlock.html">db_deadlock</a> utility source code for an example of using DbLockTab.detect
in a POSIX 1003.1 environment.
<p>
The DbLockTab.detect
method throws an exception that encapsulates an <b>errno</b> on failure.
<p>
<h1>Errors</h1>
If a fatal error occurs in Berkeley DB, the DbLockTab.detect method may fail and throw a
<a href="../../api_java/DbRunRecoveryException/class.html">DbRunRecoveryException</a>, at which point all subsequent database
calls will also fail in the same way.
<p>
The DbLockTab.detect
method may fail and throw an exception
for any of the errors specified for the following Berkeley DB and C library
functions:
abort(3),
fcntl(3),
fflush(3),
fprintf(3),
free(3),
fsync(3),
getpid(3),
lseek(3),
malloc(3),
memcpy(3),
memset(3),
mmap(3),
munmap(3),
shmat(3),
shmdt(3),
sprintf(3),
strerror(3),
vfprintf(3),
vsnprintf(3),
and
write(3).
<p>
<h1>Class</h1>
<a href="../../api_java/DbLockTab/class.html">DbLockTab</a>
<p>
<h1>See Also</h1>
<a href="../../api_java/DbLockTab/close.html">DbLockTab.close</a>,
DbLockTab.detect,
<a href="../../api_java/DbLockTab/get.html">DbLockTab.get</a>,
<a href="../../api_java/DbLockTab/id.html">DbLockTab.id</a>,
<a href="../../api_java/DbLockTab/open.html">DbLockTab.open</a>,
<a href="../../api_java/DbLockTab/stat.html">DbLockTab.stat</a>
<a href="../../api_java/DbLockTab/unlink.html">DbLockTab.unlink</a>
and
<a href="../../api_java/DbLockTab/vec.html">DbLockTab.vec</a>.
</tt>
</body>
</html>
